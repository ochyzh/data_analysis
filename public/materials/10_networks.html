<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>POL 304: Using Data to Understand Politics and Society</title>
    <meta charset="utf-8" />
    <meta name="author" content="Olga Chyzh [www.olgachyzh.com]" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# POL 304: Using Data to Understand Politics and Society
]
.subtitle[
## Intro to Network Analysis
]
.author[
### Olga Chyzh [www.olgachyzh.com]
]

---




## Today's Class

 1. Definitions. What is network analysis?
 
 2. Network data
 
 3. Network features and measurements
 
 4. An application: modeling contagion

---

## Would You Win $1,000,000?

Suppose you are playing the following game:

If you can get all your friends to meet you at the entrance to the ROM in exactly 1 hour, you will win $1,000,000. The catch is that you can only contact one friend, and not all your friends know each other. Which friend would you call and why?

---

| Sender | Receiver |
|----------|----------|
| 1    | 2, 3   |
| 2    |1, 3, 4, 5   |
| 3    | 1, 2, 4, 5  |
| 4    |2, 3, 5, 7  |
| 5    | 2, 3, 4, 6, 7   |
|6     |5, 7, 8   |
|  7    | 4, 5, 6   |
| 8    |6, 9, 12   |
|9    | 8, 10   |
| 10   |9  |
| 11   | 12  |
| 12   | 8, 11, 13, 14, 15, 16  |
| 13   | 12 |
| 14   | 12 |
| 15   | 12 |
| 16   | 12 |

---
## Visualization of the Friends Network


&lt;img src="10_networks_files/figure-html/unnamed-chunk-1-1.png" width="600px" style="display: block; margin: auto;" /&gt;
 



---
## Discussion

- What criterion helps spread the message in the fewest possible steps?

- What are social science applications of this game?

---

## Why Do We Need Network Analysis?
Suppose you walked into a dining room that hosts a luncheon at a conference you are currently attending. What table would you sit at?

&lt;img src="images/seating_chart.jpg" width="400px" style="display: block; margin: auto;" /&gt;


---
class: inverse, middle, center

# Network Analysis: Formal Definitions

---

## What is a network (i.e., a graph)?

A set of **nodes** and **relation(s)** defined on them

&lt;img src="images/madmen.png" width="400px" style="display: block; margin: auto;" /&gt;
---

## Defining a Network: What's a node?

- A &lt;span style="color:DarkCyan"&gt;**node**&lt;/span&gt; can be defined as an entity that can form relations with other entities. 

**Synonyms**: 

- actor: from sociometry, common terminology in sociology and psychology
- vertex: from graph theory (i.e., math), common terminology in mathematics and physics

Term node is common in statistics and applied sciences outside of soc and psych.
---
## Examples of Nodes

- Individuals (Mad Men characters, legislators, terrorists)

- Families 

- Organizations, Human Rights NGOs

- Countries
---
## Defining Network: What's a tie? 

- A &lt;span style="color:DarkCyan"&gt;**relation/tie**&lt;/span&gt; defines the existence of an attribute relating nodes. 

**Synonyms**: 

- link: common in computer science (e.g., huge lit on “Link Prediction”) and social sciences
- edge: graph theoretic terminology common in physics and math, but also elsewhere

**Ties can have characteristics**: 

- Weight
- Qualitative attributes
- Direction
---
## Examples of Ties

- Romantic relationship, marriage, friendship

- Business relationship

- Cooperation/conflict
---

## Network graphs can reveal important structures


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="images/p1.png" alt=" " width="49%" height="10%" /&gt;&lt;img src="images/p2.png" alt=" " width="49%" height="10%" /&gt;
&lt;p class="caption"&gt; &lt;/p&gt;
&lt;/div&gt;
---
## Adolescent romantic and sexual networks  

&lt;img src="images/jefferson.jpg" width="600px" style="display: block; margin: auto;" /&gt;
**Bearman, Moody and Stovel**
---
## Adolescent Social Structure by **Jim Moody**
&lt;img src="images/schoolGrade.png" width="600px" style="display: block; margin: auto;" /&gt;

---
## Adolescent Social Structure by **Jim Moody**
&lt;img src="images/schoolRace.png" width="600px" style="display: block; margin: auto;" /&gt;

---
class: inverse, middle, center

# Other Important Definitions


---
## An Adjacency Matrix 
Network data are often stored in the form of *adjacency matrices* whose `\(ij^{th}\)` element represents the relationship between nodes `\(i\)` and `\(j\)`.


```
##              Acciaiuoli Albizzi Barbadori Bischeri Castellani Ginori
## Acciaiuoli            0       0         0        0          0      0
## Albizzi               0       0         0        0          0      1
## Barbadori             0       0         0        0          1      0
## Bischeri              0       0         0        0          0      0
## Castellani            0       0         1        0          0      0
## Ginori                0       1         0        0          0      0
## Guadagni              0       1         0        1          0      0
## Lamberteschi          0       0         0        0          0      0
## Medici                1       1         1        0          0      0
## Pazzi                 0       0         0        0          0      0
## Peruzzi               0       0         0        1          1      0
## Pucci                 0       0         0        0          0      0
## Ridolfi               0       0         0        0          0      0
## Salviati              0       0         0        0          0      0
## Strozzi               0       0         0        1          1      0
## Tornabuoni            0       0         0        0          0      0
```

---

## Network Measures: Centrality


- Centrality measures help understand:

  + **"Which node is the most important or central in this network?"**
  
  + What do you mean by "important"?
  
  + What do you mean by "center"?
  
  + Definition of "center" varies by context/purpose
    
    + The power a person holds in an organization may be inversely proportional to the number of keys on their keyring 
      
      + A janitor has keys to every office, and no power
      
      + The CEO does not need a key: people always open the door for her
---

## Florentine Families

Who looks central? 

&lt;img src="10_networks_files/figure-html/unnamed-chunk-10-1.png" width="500px" style="display: block; margin: auto;" /&gt;

---
## Network Measures: Degree Centrality

- **Idea**: The nodes with more connections to others are more central

- How to  measure: node `\(i\)`'s degree is the sum of its direct ties.

- Though simple, degree is often a highly effective measure of the influence or importance of a node
  
  + In many situations, people with more connections tend to have more power


- Examples where this might be useful? 

---

## Florentine Families: an Adjacency Matrix

How would you calculate Albizzi's degree centrality?

```
##              Acciaiuoli Albizzi Barbadori Bischeri Castellani Ginori
## Acciaiuoli            0       0         0        0          0      0
## Albizzi               0       0         0        0          0      1
## Barbadori             0       0         0        0          1      0
## Bischeri              0       0         0        0          0      0
## Castellani            0       0         1        0          0      0
## Ginori                0       1         0        0          0      0
## Guadagni              0       1         0        1          0      0
## Lamberteschi          0       0         0        0          0      0
## Medici                1       1         1        0          0      0
## Pazzi                 0       0         0        0          0      0
## Peruzzi               0       0         0        1          1      0
## Pucci                 0       0         0        0          0      0
## Ridolfi               0       0         0        0          0      0
## Salviati              0       0         0        0          0      0
## Strozzi               0       0         0        1          1      0
## Tornabuoni            0       0         0        0          0      0
```


---

## Network Measures: The Shortest Path

- The (geodesic) distance: `\(d_{i,j}\)` is the minimal path length from `\(i\)` to `\(j\)`.

- Example: Can identify and count all nodes within the shortest path of `\(2\)` from *i*

- Useful for modeling contagion, or spread of information.

---

## The Shortest Path: Calculation

Let `\(A_{ij}\)` represent the adjacency matrix associated with a network of interest. It turns out that the `\(ij^{th}\)` element of `\(A^2\)` will give you the number of the shortest paths of length 2 between `\(i\)` and `\(j\)`.

.pull-left[

`\(A\)`

```
##    1 2 3 4 5 6 7 8 9 10
## 1  0 0 0 0 0 0 0 0 1  0
## 2  0 0 0 0 0 1 1 0 1  0
## 3  0 0 0 0 1 0 0 0 1  0
## 4  0 0 0 0 0 0 1 0 0  0
## 5  0 0 1 0 0 0 0 0 0  0
## 6  0 1 0 0 0 0 0 0 0  0
## 7  0 1 0 1 0 0 0 1 0  0
## 8  0 0 0 0 0 0 1 0 0  0
## 9  1 1 1 0 0 0 0 0 0  0
## 10 0 0 0 0 0 0 0 0 0  0
```
]

.pull-right[
`\(A^2\)`

```
##    1 2 3 4 5 6 7 8 9 10
## 1  0 1 1 0 0 0 0 0 0  0
## 2  1 0 1 1 0 0 0 1 0  0
## 3  1 1 0 0 0 0 0 0 0  0
## 4  0 1 0 0 0 0 0 1 0  0
## 5  0 0 0 0 0 0 0 0 1  0
## 6  0 0 0 0 0 0 1 0 1  0
## 7  0 0 0 0 0 1 0 0 1  0
## 8  0 1 0 1 0 0 0 0 0  0
## 9  0 0 0 0 1 1 1 0 0  0
## 10 0 0 0 0 0 0 0 0 0  0
```
]

---

## Matrix Multiplication Refresher

&lt;img src="images/matrix_mult.jpg" width="800px" style="display: block; margin: auto;" /&gt;

---
class: inverse, middle, center
# Lab: A Network Model fo Contagion



---
## Example: High-School Friendships


1. Open and explore the data

2. Notice that the data contain 2 waves (fall and spring), each stored as an adjacency matrix.


```r
library(sna)
data(coleman)
coleman[1,1:10,1:10]
```

```
##    1 2 3 4 5 6 7 8 9 10
## 1  0 0 0 0 0 0 0 0 0  0
## 2  0 0 0 0 0 0 0 0 0  0
## 3  0 0 0 0 0 0 0 0 1  0
## 4  0 0 0 0 1 0 0 0 0  0
## 5  0 0 0 0 0 0 0 0 0  0
## 6  0 0 0 0 0 0 0 0 0  0
## 7  0 0 0 0 0 0 0 0 0  0
## 8  0 0 0 0 0 0 0 0 0  0
## 9  0 0 0 0 0 0 0 0 0  0
## 10 0 0 0 0 0 0 0 0 0  0
```


---
## Make a Network Visualization

Convert to an `igraph` object:


```r
library(igraph)
ggraph&lt;-graph_from_adjacency_matrix(coleman[1,,], mode="undirected", diag=FALSE)
plot(ggraph, vertex.color="black", vertex.size=5, vertex.label=NA)
```

&lt;img src="10_networks_files/figure-html/unnamed-chunk-16-1.png" width="500px" style="display: block; margin: auto;" /&gt;

---
## Calculate Degree Centrality for Each Node


```r
degree.cent &lt;- igraph::degree(ggraph)
degree.cent
```

```
##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 
##  5  2  2  4  3  3  1  2  6  1  5  4  6  4  3  4  3  5  6  8 12 10  9  1  0  6 
## 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 
##  4  2  3  2  4  5  5  2  4  5  3  7  5  6  6  6 10  1  5  4  5  6  6  7  6  7 
## 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 
##  6 10  8  3  6  3  4  5  4  5  6  5  6  7  6 10  7 10 10  0  0
```


---

## Visualize Information Spread

1. Select the first individual to share the information with (the seed).

2. Color the seed node red. 


```r
V(ggraph)$color &lt;- ifelse(V(ggraph)$name == 21, "red", "grey")
plot(ggraph)
```

&lt;img src="10_networks_files/figure-html/unnamed-chunk-18-1.png" width="400px" style="display: block; margin: auto;" /&gt;

---

## Shortest Path of 1


```r
neighbors(ggraph,21)
```

```
## + 12/73 vertices, named, from 1a6ab0a:
##  [1] 1  2  9  12 13 14 20 22 38 51 54 55
```

```r
V(ggraph)$color &lt;- ifelse(V(ggraph)$name %in% neighbors(ggraph,21), "pink", "grey")
V(ggraph)$color[V(ggraph)$name == 21]&lt;- "red"
plot(ggraph)
```

&lt;img src="10_networks_files/figure-html/unnamed-chunk-19-1.png" width="300px" style="display: block; margin: auto;" /&gt;


---

## Shortest Path of 2

1. Convert `ggraph` to an adjacency matrix, A.

2. The elements of `\(A^2\)` will give you the number of shortest paths of length 2 between `\(i\)`'s and each other node.

3. Select nodes that have 1 or more shortest path of length 2 to node 21.


```r
mynet&lt;-as.matrix(igraph::as_adj(ggraph))
mynet2&lt;-mynet%*%mynet
diag(mynet2)&lt;-0 #a node cannot be connected to itself
neighbors2&lt;-names(mynet2[21,][mynet2[21,]&gt;0])
neighbors2
```

```
##  [1] "1"  "2"  "3"  "6"  "8"  "9"  "12" "13" "14" "15" "17" "20" "22" "24" "28"
## [16] "29" "38" "45" "46" "49" "51" "54" "55" "57" "59" "63" "69" "70" "71"
```

---

```r
V(ggraph)$color &lt;- ifelse(V(ggraph)$name %in% neighbors2, "mistyrose", "grey")
V(ggraph)$color[V(ggraph)$name %in% neighbors(ggraph,21)]&lt;- "pink"
V(ggraph)$color[V(ggraph)$name == 21]&lt;- "red"
plot(ggraph, vertex.label=NA)
```

&lt;img src="10_networks_files/figure-html/unnamed-chunk-21-1.png" width="600px" style="display: block; margin: auto;" /&gt;



---

## Your Turn

Below if the code to create the hypothetical friendship network used in the opening example.

- Model the spread of information in this network using "12", "6", and "8" as the seed. 


```r
el &lt;- matrix( c("1", "2", "1", "3","2","3","3","5","2","4","2","5","3","4","4","5","4","7","6","5","5","7","6","7","6","8", "8","9","9","10", "8","12", "11","12",  "12","13","12","14","12","15","12","16"), nc = 2, byrow = TRUE)
g&lt;-graph_from_edgelist(el, directed=F)
```


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
